# Функция, с которой начинается выполнение программы
function main
{
# оператор push кладет на вершину стэка целое число
# или значение переменной
push 3

# Вызов функции factorial с параметром 3
call factorial

# Вызов внешней функции вывода на консоль числа,
# которое находится на вершине стэка. Вершина стэка извлекается.
callext print

push 10000
push 341

# Выход из функции
return
}

# Объявление функции вычисления факториала.
# Можно объявлять функции ниже их места использования.
function factorial
{
# Продублируем первый аргумент программы (аргумент n)
dup

push 0

# Проверим равна ли копия n нулю, если да,
# тогда переходим к метке возврата факториала для нуля.
ifeq zero_factorial

# Аргумент не равен нулю, значит продолжаем вычисление факториала.
# Создадим копию n и уменьшим ее на единицу – это n-1
dup

push 1

sub

# Найдем factorial(n-1)
call factorial

# Найдем произведение n * factorial(n-1)
mul

# Выходим из функции, а на вершине стэка лежит n * factorial(n-1)
return

zero_factorial:

pop

push 1

# Возвращаем управление в вызывающую функцию
return
}